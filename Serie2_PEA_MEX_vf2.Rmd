---
title: "Serie2_PEA_MEX_v"
author: "Sergi"
date: "2023-03-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Serie de tiempo 2 CON tendencia y SIN estacionalidad: Historico trimestral de Población Económicamente Activa (PEA) en México

Tenemos data trimestral de Enero de 2005 a Agosto de 2022 sobre la Población Económicamente activa en México, son 72 datos en total. 
La idea es usar 66 de esos 72 como una especie de "data de entreaniemto" para aplicar los modelos A) De suavizamiento "estático" y B) De "suavizamiento dinámico" o Holt-Winters y posteriormente predecir con cada modelo los valores de los 6 trimestres restantes y poder comparar contra los reales e identificar el mejor modelo entre los dos mencionados para modelar la Población Económicamente Activa en México 



Primero importamos la data de PEA en MEX
Data obtenida de la página oficial del INEGI:  https://www.inegi.org.mx/temas/empleo/

```{r}

library("readxl")

PEA_mex <-read_excel("PEA_MEX_pp.xlsx")
```


Revisamos que la data de nacimientos MEX sehay importado correctamente 
```{r}
head(PEA_mex)
summary(PEA_mex)
typeof(PEA_mex)
dim(PEA_mex)
```


Graficamos la "data original" de PEA en México de los últimos años (Enero 2005 a Oct 2021)  

```{r}

plot(PEA_mex$Date, PEA_mex$PEA,type="l", main="Data 'original' de Población Económicamente Activa (PEA) en México")
```


## A. Método de "suavizamiento estático"

Comenzaremos tratando la serie con el método estático aplicando el siguiente flujo lógico de trabajo y considerando que estamos ene el caso de serie CON TENDECIA y SIN ESTACIONALIDAD: 

1. Se removerá el factor de tendencia a la serie original obteniendo una serie sin tendencia
2. Será sobre dicha serie sin tendecia que se llevará a cabo el "pronóstico puntual" de los siguientes 6 trimestre como la media historica de dicho componente estocástico 
3. Se calcularán los intervalos de pronóstico al 95% de confianza 
4. Se "devolverán" los efectos de tendencia de la serie con el fin de llevar los pronósticos a las dimensiones correctas
5. Se calculará el error tipo MAPE entre los valores pronósticados con el "método estático" y los valores reales de la serie de los últimos 6 trimestres


### A.1 Remoción de tendencia de serie original  

Primero se calculará la linea "general" de tendencia de nuestra serie de (que representa la tendencia de la "serie de datos originales") y se removerá dicha tendencia de la 'data original' de PEA_mex


Calculemos la linea de tendencia 
```{r}

linea_PEA<-lm(PEA~Date, data=PEA_mex)
linea_PEA
```

Se puede observar una "ecuación general de linea de tendencia" en este caso es: 
y = 17,890,000 + 0.02397 * (Date) 
Es muy razonable que "la ordenada al origen" sea de alrededor de 20 millones, pues todos los datos de Población Económicamente Activa son del orden de 40 a 55 millones. También resulta lógica que el valor de la pendiente sea positivo pero no muy cercano a 1, pues en general para cada aumento en el valor del tiempo, no existe un incremento o decremento realmente signifiativo en el valor del PEA (excepto en el año 2020)



Ahora para graficar la "serie original" de PEA_MEX vs el filtro1 (Linea de tendencia) primero debemos "crear/simular" datos de Enero 2005 a Oct 2021 a partir de nuestra linea de previamente computada de nombre: linea_PEA


```{r}
linea_PEA_aplicada <- predict(linea_PEA, newdata = data.frame(Date = PEA_mex$Date))

head(linea_PEA_aplicada)
tail(linea_PEA_aplicada)

```


Graficamos entonces a la "data original de PAE_MX" y a la data calculada a partir de la linea tendencia


```{r}
plot(PEA_mex$Date, PEA_mex$PEA, type="l", main=" 'data original de PAE_MX' y linea de tendencia calculada")
lines(x = PEA_mex$Date, y = linea_PEA_aplicada, col = "red")

legend("bottomright", legend = c("data original de PAE_MX", "Linea de tendencia de PEA en MEX"), 
       col = c("black", "red"), lty = 1)

```


Ahora vamos a "quitar el efecto de la tendencia" de nuestra "serie original de datos"
En este caso se asumirá un "efecto multiplicativo" y por lo tanto se removerá dividiendo cada elemento de la serie original / valor de la linea de tendnecia en ese valor de x

Se grafica la serie sin tendencia:

```{r}
PEA_Sin_Tendencia<-PEA_mex$PEA/linea_PEA_aplicada

plot(PEA_mex$Date, PEA_Sin_Tendencia, type="l", main=" Data sin tendencia de PAE_MX ", col="brown")
```

### A.2 Tratamiendo del ruido blanco en la serie y pronostico puntual  

Considerese el siguiente razonamiento acerca de las series del tiempo: 
Serie total = Componente de tendencia + Componente de estacionalidad + Componente estocástico 

En este caso el Componente de estacionalidad = 0, por lo tanto tendríamos 

Serie total PAEA MEX = Componente de tendencia + Componente estocástico, por lo tanto al haber previamente removido el componente estocástico de la serie lo que hemos hecho en realidad es obtener el componente estocástico o ruido blanco para este caso 

Por simplicidad para cálculos posteriores, nombremos de esa manera a la variable 
```{r}
PEA_MX_ruido_blanco <- PEA_Sin_Tendencia
head(PEA_MX_ruido_blanco)
tail(PEA_MX_ruido_blanco)
```


Una vez teniendo únicamente el componente estocástico de nuestra serie, es posible "extraer los errores" de la serie y conocer así el error estimado (varianza)  y la desviación estandar. 
La idea es que extrayendo de la serie del ruido blanco su media histórica estaríamos determinando la varianza, de la siguiente manera:

Varianza (errores al cuadrado) = Serie original - tendecia - media de componete estocástico. En nuestro caso, dichos errores será nuestra serie sin tendencia - mean(PEA_MX_ruido_blanco).  Nosotros hemos ya calculado el resultado de Serie original - tendecia y lo hemos llamada justamente ruido blanco y lo lo tanto el calculo del error podría resumirse a  

Errores= Componente estocástico o ruido blanco - Media del componente estocástico o ruido blanco



Se determinan la varianza (errores al cuadrado) de la serie de PEA_MEX y se calcula también la desviación estandar de esos errores 

```{r}
Error_est_PEA<-PEA_Sin_Tendencia-mean(PEA_MX_ruido_blanco)
head(Error_est_PEA)
tail(Error_est_PEA)

##Claculando la desviaicón estandar del error

sd_est_PEA<-sd(Error_est_PEA)
sd_est_PEA

plot(PEA_mex$Date, Error_est_PEA, type="l", main="Errores al cuadrado (varianza) de la aplicaicón del modelo de 'suavizamiento estático' a la serie de PAE MX ", cex.main=0.6)

```


Se calcula la media de los errores 
```{r}


mean(Error_est_PEA)
```

Se calcula la varianza  y desviación estandar de los errores 
```{r}
## Se calcula la varianza
var(Error_est_PEA)

## Se calcula la desviación estandar 
sd_est_PEA
```

Se tiene una desviación estandar de 0.025 y una  media muy cercana a cero para los errores lo cual es totalmente concordante con le hecho de que tras haber removido el componente de tendencia, "el ruido blanco" o componente estocástico resultante tiende a tener una distribuión normal. Y que si a ese ruido blanco se le extrae su media tambien tiende a tener una distribución normal con media cero y en este caso una desviación estandar de 0.025



Procedamos a observar como se comporta la Distribución de dichos errores:
```{r}
hist(Error_est_PEA, breaks = 20, col = "lightblue", main = "Frequency Distribution of PEA MEX errors", xlab = "Values", ylab = "Frequency")

```
Se observa como los errores de la serie siguen prácticamente todos una distribución normal con media cero y desviación estandar de 0.025, a excepción de los valores atípicos del año 2020 derivados de la pandemia de Covid-19.


#### Pronóstico puntual
Una vez teniendo nuestra seríe SIN TENDENCIA lo que como ya se mencionó, implica que, "unicamente tenemos el componente estocástico o de ruido blanco en la serie" podemos proceder a llevar a cabo el pronóstico de 6 trimestres.

Como ha sido estudiado en la clase, nuestro mejor pronóstico puntual dadas estas condiciones en la serie es la media de los datos históricos del ruido blanco


```{r}
estimacion_puntual_PEA_ST<-mean(PEA_Sin_Tendencia)
estimacion_puntual_PEA_ST

```



Ahora vamos a hacer el pronóstico de la serie de PEA MEX para los próximos 6 trimestres


```{r}
##Creamos un eje x que incluya a los 66 datos + 6 que se pronosticarán
Date_PAE2<-c(1:72)


## Creamos el vector de datos que incluirá los  datos históricos  sin tendencia + 6 valores NA a pronosticar
PAE_Sin_Tendencia_para_pron<-c(PEA_Sin_Tendencia, rep(NA, times=6))
head(PAE_Sin_Tendencia_para_pron)
tail(PAE_Sin_Tendencia_para_pron)


## Entonces el mejor pronóstico que tenemos para esta técnica es la media de la serie sin tendencia 


PEA_pronostico_puntual <- rep(estimacion_puntual_PEA_ST, times=72)
head(PEA_pronostico_puntual)
tail(PEA_pronostico_puntual)

plot(Date_PAE2,PEA_pronostico_puntual, type="l", main = "Estimación 'puntual' de PEA en MEX", cex.main=0.8, ylim=c(0.9, 1.1))
```



Comentario sobre el pronóstico puntual sin tendencia ni estacionalidad, que para el caso de la serie de esta serie tiene un valor de:
```{r}
mean(PEA_MX_ruido_blanco)
```
Este valor es bastante concordante con el hecho que. Al haber "quitado los componentes de tendencia de la serie original", es decir obtenido el ruido blanco de la serie los valores de nuestra variable y: PEA en Mex están en este momento del algoritmo en escala de la unidad: 1. Y por lo tanto la media de dichos valores será muy cercana a 1. 

En general se podría decir dados los resultados del presente trabajo, así como los resultados de los ejercicios vistos en clase, que el valor de la media estimada o pronóstico puntual para la serie sin componente de tendencia tiende al valor de 1. 



### A.3 Calculo de intervalos de confianza para el pronóstico

Calculamos los límites de intervalos de confianza al 95% pata el pronostico 
Se considera 95% como +- 2 desviaciones estandar de la media

```{r}
tao<-c(1:6)
Lim_PEA<-2*sd_est_PEA*tao^.5
Lim_PEA
```


Calculamos los limites inferior y superior

```{r}

LI_PEA<-c(rep(NA, times=66), estimacion_puntual_PEA_ST-Lim_PEA)
head(LI_PEA)
tail(LI_PEA)

LS_PEA<-c(rep(NA, times=66), estimacion_puntual_PEA_ST+Lim_PEA)
head(LS_PEA)
tail(LS_PEA)

plot(Date_PAE2, PAE_Sin_Tendencia_para_pron, type="l", ylim = c(0.7,1.3) ,main="Estimación puntual e intervalos de confianza sin tendencia para PAE MEX con el método de 'suavizamiento estático'",col="Blue", cex.main=0.7)

lines(PEA_pronostico_puntual, col="Red")
lines(LI_PEA, col="Purple")
lines(LS_PEA, col="Purple")
```



### A.4 "Devolución de efectos de tendencia y estacionalidad a los pronósticos e intervalos calculados"


Ahora vamos a "llevar nuestro pornóstico a las dimensiones reales"
Para ello primero vamos a "devolver la tendencia a la serie" de nombre PEA_Sin_Tendencia   

Para eso primero necesitamos "crear un data frame que contenga la información histórica + 6 de pronóstico con un valor NA 


```{r}
# create a new data set with 72 rows
extended_dates <- seq(as.Date("2005-01-01"), as.Date("2022-10-01"), by = "quarter")
extended_trimester_PEA <- data.frame(Date = extended_dates, 
                                       PEA = rep(NA, length(extended_dates)))

head(extended_trimester_PEA)
tail(extended_trimester_PEA)

```



```{r}


# copy the original data to the new data set for the first 66 rows
for(i in 1:66){
  extended_trimester_PEA$PEA[i] <- PEA_mex$PEA[i]
}

extended_trimester_PEA


# fit the model with the extended data set
linea_PEA_extended <- lm(PEA ~ Date, data = extended_trimester_PEA)
linea_PEA_extended

```



Posteriormente calculamos los valores historicos + 6  pronosticados a partir de la linea de tendencia que previamente se habia calculado de nombre linea_PEA_extended

```{r}
# predict values for the extended date range
linea_PEA_extended_aplicada <- predict(linea_PEA_extended, 
                                                newdata = data.frame(Date = extended_dates))
linea_PEA_extended_aplicada

# plot the predicted values
plot(extended_dates, linea_PEA_extended_aplicada, type = "l", main="Linea de tendencia aplicada a los datos históricos de PEA MEX")
```

Entonces para finalmente "devolver el efecto de la tendnecia a los datos de media_nacimientos_ST" se multiplica cada valor de la serie por el valor calculado a partir de la linea de tencia que se llama: linea_PEA_extended_aplicada

```{r}

##Creando el vector original + los valores a predecir como NAs
PEA_original_para_pron<-c(PEA_mex$PEA, rep(NA, times=6))
head(PEA_original_para_pron)



Est_punt_PEA_ajustada<-c(rep(NA, times=66), mean(PEA_pronostico_puntual)*linea_PEA_extended_aplicada[67:72])
head(Est_punt_PEA_ajustada)
tail(Est_punt_PEA_ajustada)

# plot the original data and the predicted values together
plot(extended_dates, PEA_original_para_pron, main="PEA estimación puntual ajustada con componente de estacionalidad (con método estático)",type="l", xlab="Year", ylab="PEA", cex.main=0.8)
lines(extended_dates, Est_punt_PEA_ajustada, col="blue")


legend("bottomright", legend = c("PEA historico", "Pronóstico puntual calculado con método estático"), 
       col = c("black", "blue"), lty = 1)


```


Calculamos ahora los límites de estimación devolviendo el efecto de tendencia 


Para ello importamos el Data Frame con la data historica completa, es decir, la que contiene los 66 trimestres propuestos aquí como "train data" + los 6 trimestres que se pronósticaran

```{r}

library("readxl")

PEA_MEX_completa <-read_excel("PEA_MEX_full.xlsx")
head(PEA_MEX_completa)
tail(PEA_MEX_completa)
```



```{r}

LI_PEA_ajustado<-c(rep(NA, times=66), LI_PEA[67:72]*linea_PEA_extended_aplicada[67:72])
LI_PEA_ajustado

LS_PEA_ajustado<-c(rep(NA, times=66), LS_PEA[67:72]*linea_PEA_extended_aplicada[67:72])
LS_PEA_ajustado


# Plot only non-NA values
# plot the original data and the predicted values together


PEA_original_para_pron<-c(PEA_mex$PEA, rep(NA, times=6))
PEA_original_para_pron
dim(PEA_original_para_pron)


# plot the original data and the predicted values together
plot(extended_dates,PEA_MEX_completa$PEA, main="PEA estimación puntual e intervalos de confianza ajustada con componente de trend (con método estático) vs PEA real", type="l", xlab="Year", ylab="PEA", ylim=c(40000000, 65000000), cex.main=0.6)

lines(extended_dates, Est_punt_PEA_ajustada, col="blue")
x_vals <- c(rep(NA, times = 66), extended_dates[67:72])

lines(x_vals, LI_PEA_ajustado, col = "purple")
lines(x_vals, LS_PEA_ajustado, col = "purple")


legend("bottomright", legend = c("PEA original", "Pronóstico puntual calculado con método estático"), 
       col = c("black", "blue"), lty = 1)


```


Visualizamos el Data.Frame con los valores históricos la "data original" + los resultados del pronóstico puntual y los intervalos de confianza al 95% 

```{r}
df_demanda_PEA_MX_pronostico<-data.frame(PEA_MEX_completa$PEA,
                                                Est_punt_PEA_ajustada, LI_PEA_ajustado, LS_PEA_ajustado)
View(df_demanda_PEA_MX_pronostico)

tail(df_demanda_PEA_MX_pronostico)
```


Se observa que los pronósticos puntuales vs los reales parecen no estar muy alejados unos de otros, sin embargo los intervalos de confianza si "sufren a medida que nos alejamos del último valor real" pues son cada vez más grandes hasta llegar a abarcar un rango de [50,000000 a 65,000000] para el 95% de intervalo de confianza en el 6t0 valor pronósticado. Lo que representa alrededor del 25% del rango de nuestra variable y.


### A.5 Calculo del error tipo MAPE para los pronósticos hechos con los modelos estáticos de suavizamiento

Calculemos el error tipo MAPE entre los valores pronosticados con el "método de suavizamiento estático" y los valores reales de la serie 


```{r}

##Primero formemos un vector con los valores reales 
PEA_MEX_completa_reales6 <- PEA_MEX_completa$PEA[67:72]
PEA_MEX_completa_reales6

## Despues formemos un vector con únicamente los valores pronósticados 
PEA_MEX_forecast6 <- Est_punt_PEA_ajustada[67:72]
PEA_MEX_forecast6

##Calculemos el MAPE entre estos dos vectores 

# First, calculate the absolute percentage error (APE) for each element in the vectors
APE_PEA_estatico <- abs((PEA_MEX_completa_reales6 - PEA_MEX_forecast6) / PEA_MEX_completa_reales6)

# Calculate the mean APE across all elements in the vectors
MAPE_PEA_estatico <- mean(APE_PEA_estatico) * 100

# Print the MAPE value
cat("El error tipo MAPE  para el forecast calculado con el método de 'suavizamiento estático'de la serie de PEA en MEX es:", MAPE_PEA_estatico, "%")


```



## B. Método de Holt como "modelo de suaviazamiento y pronóstico NO ESTÁTICO" que si considera los cambios de nivel a tráves del tiempo. 

Vamos a usar ahora el método de HoltWinters como "modelo de suaviazamiento y pronóstico NO ESTÁTICO" que si considera los cambios de nivel a tráves del tiempo. 


Para ello debemos tener nuestra data a suavizar en el tipo de dato serie de tiempo ts en R 

```{r}
PEA_MEX_ts <-ts(PEA_mex$PEA, frequency =4, start =c(2005,1))
head(PEA_MEX_ts)
tail(PEA_MEX_ts)
```

Graficamos la "data original de la PEA_MEX" que se usará como "train para el modelo" y que fue convertida a tipo de dato serie de tiempo 

```{r}
plot(PEA_MEX_ts, main="PAE MEX train data en tipo time series (Valores de Enero de 2005 a Agosto de 2021)", cex.main=0.8)
```


### Aplicación del método de Holt Winters" a la serie CON TENDENCIA y SIN ESTACIONALIDAD de PEA MEX

Como se observará este primer cálculo dejará como grados de libertad los valores de alpha, gamma y betha, así como los valores de arranque, de manera que el "el algoritmo de HoltWinters de R" determine la "mejor combinaión posible".
Como en este caso no tenemos componente de seasonalidad se indica que el parámetro gamma tendrá un valor "false"

```{r}
PEA_MEX_ts_h1 <-HoltWinters(PEA_MEX_ts, gamma=FALSE)
PEA_MEX_ts_h1
```



#### Interpretación de los valores de los coeficientes del método de Holt Winters para el caso de la serie de PEA en México

Interpretación de los valores de coficientes $\alpha$ y $\beta$ para el caso del pronóstico usando modelo de HoltWinters SIN ESPECIFICAR DATOS DE ARRANQUE    


$$0<\alpha<1$$

Recordemos que: 
Valores de $\alpha$ cercano a 1 reflejan caminata aleatoria
Valores de $\alpha$ cercano a 0 reflejan una "gran influencia" de los valores pasado, es decir, que "el ruido no es un componente de gran relevancia"

En nuestro caso el valor de $\alpha$ es:
```{r}
PEA_MEX_ts_h1$alpha
```
Lo que indica que "La data historica SI tiene UNA RELEVANCIA SIGNIFICATIVA vs el componente meramente estocástico"


$$0<\beta<1$$
Recordemos que: 
Valores de $\beta$ cercano a 1 reflejan cambios CONSTANTES de nivel a lo largo de la serie 
Valores de $\beta$ cercano a 0 reflejan POCOS cambios de nivel a lo largo de la serie  


En nuestro caso el valor de $\beta$ es:
```{r}
PEA_MEX_ts_h1$beta

```
Lo que indica muy pocos cambios de nivel a lo largo de la serie o una especie de "pendiente constante"


Y entonces para el caso de valores de $\alpha$ cercanos a 0 y de $\beta$ cercanos a cero (como es nuestra serie de demanda_electrico) indica una serie que otorga mucha relevancia a los valores históricos  y con CAMBIOS DE NIVEL MUY BAJOS

Afortunadamente no obtuvimos simultaneamente valores de$\alpha$ cercanos a 1 y de $\beta$ cercanos a 1 pues eso reflejaría una CAMINATA ALEATORIA con tendencia estocástica que sería prácticamente imposible de pronósticar. 




### Pronóstico de la serie de PEA en MEX con el método de Holt Winters 

Ahora pasemos a realizar los pronósticos de la serie pero con el método de HoltWinters que considera cambios dinámicos de nivel 

Graficamos los valores originales vs suavizados con el método de Holt-Winters


```{r}
plot(PEA_MEX_ts_h1, main="Aplicaicón del método de Holt Winters a PEA MEX train data")
```


```{r}
# Load the forecast package
library(forecast)
```



Ahora se llevará a cabo el pronóstico con la librería de forecast y basados en el método de Holt Winters. De igual manera se usará un intervalo de confianza del 95%

```{r}
PEA_MEX_ts_h1_fc <- forecast(PEA_MEX_ts_h1, h=6, level=0.95)
PEA_MEX_ts_h1_fc
```

Se observa como el pronóstico puntual es "relativamente bueno" y es muy parecido en valor al obtenido previamente con el método estático, sin embargo los Intervalos de confianza obtenidos con este método son BASTANTE MEJORES en comparación con los del anterior 



```{r}
plot(PEA_MEX_ts_h1_fc, main="Forecast de PAE MX usando el Método de Holt Winters con parámetro gamma ='False'", cex.main=0.8)
```




Veamos el valor la Suma de Errores al Cuadrado del pronóstico de PEA en MEX  usando el Método de suaviazamiento dinámico de HoltWinters
```{r}
PEA_MEX_ts_h1$SSE
```

Calculemos el error tipo MAPE entre los valores pronosticados con el "método de Holt Winters" y los valores reales de la serie 

```{r}

## Formemos un vector con únicamente los valores reales de los ultimos 6 trimestres 
PEA_completo_realest6 <- PEA_MEX_completa$PEA[67:72]
PEA_completo_realest6


## Formemos un vector con únicamente los valores pronósticados 
PEA_HW_forecast6 <- PEA_MEX_ts_h1_fc$mean
PEA_HW_forecast6



```


```{r}

##Calculemos el MAPE entre estos dos vectores 

# First, calculate the absolute percentage error (APE) for each element in the vectors
APE_PEA_HW <- abs((PEA_completo_realest6 - PEA_HW_forecast6) / PEA_completo_realest6)

# Calculate the mean APE across all elements in the vectors
MAPE_PEA_HW <- mean(APE_PEA_HW) * 100

# Print the MAPE value
cat("MAPE error para el forecast calculado con el método de 'HoltWinters'es:", MAPE_PEA_HW, "%")
```



### Error cuadrado calculado con el Método de HoltWinters vs el calculado con el método de suafizamiento estático 


```{r}
PEA_MEX_ts_h1$SSE
```

Entonces el error asociado al pronóstico del cálculo de pronóstico PUNTUAL para el caso Demanda_eléctirco es:  
```{r}
sse_PEA_hw <- ((PEA_MEX_ts_h1$SSE)/(length(PEA_MEX_ts)))^0.5
sse_PEA_hw
```


Recordar que la SSE de la demanda_electrico para el caso del método de suavizamiento estático era:
```{r}
SSE_PEA_E <- sum(PEA_MX_ruido_blanco^2)
SSE_PEA_E
```

Lo que indica que el método de suavizamiento estático resultó bastante mejor en nuestro caso para el PRONOSTICO PUNTUAL de la demanda de gas natural en el sector eléctrico en México vs el método de HoltWinters



### Comparación del MAPE del pronostico hecho con métodos estáticos vs el pronóstico hecho con el método " de suavizamiento dinámico" de HoltWinters para el pronostico puntual


En este caso y dado un cálculo con el métodO de HolttWinters sin valores de arranque especificados los errores de ambos métodos (estático vs HoltWinters) fueron los sigientes: 


```{r}
cat("MAPE error para el forecast calculado con el método de 'suavizamiento estático'es:", MAPE_PEA_estatico, "%")

  
cat("MAPE error para el forecast calculado con el método de 'HoltWinters'es:", MAPE_PEA_HW, "%")
```

Lo que confirma que el método de suavizamiento estático resultó mejor en nuestro caso para el PRONOSTICO PUNTUAL de la PEA en México. 


### Comparación de los intervalos del pronostico hecho con métodos estáticos vs el pronóstico hecho con el método " de suavizamiento dinámico" de HoltWinters 

Como se sabe, la parte "más sustancial" o esencial de los pronósticos es el intervalo y no el pronóstico puntual, por lo que en nuestro caso se considerará en general como "un mejor mpetodo de pronóstico" no aquel que otorge el menor error tipo MAPE en las estimaciones puntuales, sino aquel cuyos intervalos de confianza al 95% sean menores incluso para valores pronósticados relativamente lejanos del último valor real. 



Intervalos calculados con el método de suavizamiento estático
```{r}
LI_PEA_ajustado[67:72]
LS_PEA_ajustado[67:72]


intervalos_metodo_E<- data.frame(LI_PEA_ajustado_E =LI_PEA_ajustado[67:72], LS_PEA_ajustado_E= LS_PEA_ajustado[67:72])

intervalos_metodo_E

```



Intervalos calculados con el método de suavizamiento dinámico Holt-Witers
```{r}
PEA_MEX_ts_h1_fc
```

Se observa claramente como el método de HoltWinters otorga mejores intervalos de confianza para pronósticos incluso para aquellos 'más alejados' del último valor real vs aquellos generados con el "método de suavizamiento estático" 





