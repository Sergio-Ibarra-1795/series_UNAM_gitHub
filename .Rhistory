extended_dates <- seq(as.Date("1995-01-01"), as.Date("2027-01-01"), by = "year")
extended_nacimientos_mex <- data.frame(Date = extended_dates,
Births = rep(NA, length(extended_dates)))
extended_nacimientos_mex
# copy the original data to the new data set
extended_nacimientos_mex$Births[1:length(nacimientos_mex$Births)] <- nacimientos_mex$Births
extended_nacimientos_mex
# fit the model with the extended data set
linea_nacimientos_extended <- lm(Births ~ Date, data = extended_nacimientos_mex)
linea_nacimientos_extended
# predict values for the extended date range
linea_nacimientos_aplicada_extended <- predict(linea_nacimientos_extended,
newdata = data.frame(Date = extended_dates))
linea_nacimientos_aplicada_extended
# plot the predicted values
plot(extended_dates, linea_nacimientos_aplicada_extended, type = "l")
##Creando el vector original + los valores a predecir como NAs
nacimientos_original_para_pron<-c(nacimientos_mex$Births, rep(NA, times=6))
nacimientos_original_para_pron
dim(nacimientos_original_para_pron)
Est_punt_nacimientos<-c(rep(NA, times=27), media_nacimientos_ST*linea_nacimientos_aplicada_extended[28:33])
Est_punt_nacimientos
# plot the original data and the predicted values together
plot(new_dates, nacimientos_original_para_pron, type="l", xlab="Year", ylab="Births")
LI_naci_ajustado<-c(rep(NA, times=27), LI_naci[28:33]*linea_nacimientos_aplicada_extended[28:33])
LI_naci_ajustado
LS_naci_ajustado<-c(rep(NA, times=27), LS_naci[28:33]*linea_nacimientos_aplicada_extended[28:33])
LS_naci_ajustado
# plot the original data and the predicted values together
plot(new_dates, nacimientos_original_para_pron, type="l", xlab="Year", ylab="Births")
# create a new data set with 5 additional years
extended_dates <- seq(as.Date("1995-01-01"), as.Date("2027-01-01"), by = "year")
extended_nacimientos_mex <- data.frame(Date = extended_dates,
Births = rep(NA, length(extended_dates)))
extended_nacimientos_mex
# copy the original data to the new data set
extended_nacimientos_mex$Births[1:length(nacimientos_mex$Births)] <- nacimientos_mex$Births
extended_nacimientos_mex
# fit the model with the extended data set
linea_nacimientos_extended <- lm(Births ~ Date, data = extended_nacimientos_mex)
linea_nacimientos_extended
# predict values for the extended date range
linea_nacimientos_aplicada_extended <- predict(linea_nacimientos_extended,
newdata = data.frame(Date = extended_dates))
linea_nacimientos_aplicada_extended
# plot the predicted values
plot(extended_dates, linea_nacimientos_aplicada_extended, type = "l")
##Creando el vector original + los valores a predecir como NAs
nacimientos_original_para_pron<-c(nacimientos_mex$Births, rep(NA, times=6))
nacimientos_original_para_pron
dim(nacimientos_original_para_pron)
Est_punt_nacimientos<-c(rep(NA, times=27), media_nacimientos_ST*linea_nacimientos_aplicada_extended[28:33])
Est_punt_nacimientos
# plot the original data and the predicted values together
plot(new_dates, nacimientos_original_para_pron, type="l", xlab="Year", ylab="Births")
##Creando el vector original + los valores a predecir como NAs
nacimientos_original_para_pron<-c(nacimientos_mex$Births, rep(NA, times=6))
nacimientos_original_para_pron
dim(nacimientos_original_para_pron)
Est_punt_nacimientos<-c(rep(NA, times=27), media_nacimientos_ST*linea_nacimientos_aplicada_extended[28:33])
Est_punt_nacimientos
# plot the original data and the predicted values together
plot(new_dates, nacimientos_original_para_pron, type="l", xlab="Year", ylab="Births")
##Creando el vector original + los valores a predecir como NAs
nacimientos_original_para_pron<-c(nacimientos_mex$Births, rep(NA, times=6))
nacimientos_original_para_pron
dim(nacimientos_original_para_pron)
Est_punt_nacimientos<-c(rep(NA, times=27), media_nacimientos_ST*linea_nacimientos_aplicada_extended[28:33])
Est_punt_nacimientos
# plot the original data and the predicted values together
plot(extended_dates, nacimientos_original_para_pron, type="l", xlab="Year", ylab="Births")
lines(extended_dates, Est_punt_nacimientos, col="blue")
LI_naci_ajustado<-c(rep(NA, times=27), LI_naci[28:33]*linea_nacimientos_aplicada_extended[28:33])
LI_naci_ajustado
LS_naci_ajustado<-c(rep(NA, times=27), LS_naci[28:33]*linea_nacimientos_aplicada_extended[28:33])
LS_naci_ajustado
# plot the original data and the predicted values together
plot(extended_dates, nacimientos_original_para_pron, type="l", xlab="Year", ylab="Births")
lines(extended_dates, Est_punt_nacimientos, col="blue")
lines(LI_naci_ajustado, col="purple")
lines(LS_naci_ajustado, col="purple")
knitr::opts_chunk$set(echo = TRUE)
install.packages("readxl")
library("readxl")
Demanda_electrico <-read_excel("Demanda_electrico_2022_full1.xlsx")
head(Demanda_electrico)
summary(Demanda_electrico)
typeof(Demanda_electrico)
dim(Demanda_electrico)
plot(Demanda_electrico$Demanded_Gas, type = "l")
Electrico_Demanded_gas_line_aplicada <- predict(Electrico_Demanded_gas_line, newdata = data.frame(Date = Demanda_electrico$Date))
Electrico_Demanded_gas_line_aplicada
plot(Demanda_electrico$Demanded_Gas, type="l")
lines(Electrico_Demanded_gas_line_aplicada, col = "red")
Demanda_electrico_Sin_Tendencia<-Demanda_electrico$Demanded_Gas/Electrico_Demanded_gas_line_aplicada
plot(Demanda_electrico_Sin_Tendencia, type="l")
Demanda_electrico_Sin_Tendencia
dim(Demanda_electrico_Sin_Tendencia)
# Generate indices for T1, T2, T3, and T4
# Define the indices for each subset
T1_indices <- c(seq(1, 3), seq(13, 15), seq(25, 27), seq(37, 39), seq(49, 51), seq(61, 63), seq(73, 75), seq(85, 87), seq(97, 99), seq(109, 111), seq(121, 123), seq(133, 135), seq(145, 147), seq(157, 159), seq(169, 171), seq(181, 183), seq(193, 195), seq(205, 207))
T2_indices <- c(seq(4, 6), seq(16, 18), seq(28, 30), seq(40, 42), seq(52, 54), seq(64, 66), seq(76, 78), seq(88, 90), seq(100, 102), seq(112, 114), seq(124, 126), seq(136, 138), seq(148, 150), seq(160, 162), seq(172, 174), seq(184, 186), seq(196, 198), seq(208, 210))
T3_indices <- c(seq(7, 9), seq(19, 21), seq(31, 33), seq(43, 45), seq(55, 57), seq(67, 69), seq(79, 81), seq(91, 93), seq(103, 105), seq(115, 117), seq(127, 129), seq(139, 141), seq(151, 153), seq(163, 165), seq(175, 177), seq(187, 189), seq(199, 201), seq(211, 213))
T4_indices <- c(seq(10, 12), seq(22, 24), seq(34, 36), seq(46, 48), seq(58, 60), seq(70, 72), seq(82, 84), seq(94, 96), seq(106, 108), seq(118, 120), seq(130, 132), seq(142, 144), seq(154, 156), seq(166, 168), seq(178, 180), seq(190, 192), seq(202, 204), seq(214, 216))
# Create the subsets
T1 <- Demanda_electrico_Sin_Tendencia[T1_indices]
T1
T2 <- Demanda_electrico_Sin_Tendencia[T2_indices]
T2
T3 <- Demanda_electrico_Sin_Tendencia[T3_indices]
T3
T4 <- Demanda_electrico_Sin_Tendencia[T4_indices]
T4
FE1_electrico<-mean(T1)/mean(Demanda_electrico_Sin_Tendencia)
FE1_electrico
FE2_electrico<-mean(T2)/mean(Demanda_electrico_Sin_Tendencia)
FE2_electrico
FE3_electrico<-mean(T3)/mean(Demanda_electrico_Sin_Tendencia)
FE3_electrico
FE4_electrico<-mean(T4, na.rm = TRUE)/mean(Demanda_electrico_Sin_Tendencia)
FE4_electrico
Demanda_electrico_ruido<-Demanda_electrico_Sin_Tendencia/c(FE1_electrico, FE2_electrico, FE3_electrico, FE4_electrico)
Demanda_electrico_ruido
plot(Demanda_electrico_ruido, type="l")
# Repeat the FE vector to match the length of Demanda_electrico_Sin_Tendencia
FE_vec <- rep(c(FE1_electrico, FE2_electrico, FE3_electrico, FE4_electrico), length.out = length(Demanda_electrico_Sin_Tendencia))
# Divide Demanda_electrico_Sin_Tendencia by the FE vector
Demanda_electrico_ruido_2 <- Demanda_electrico_Sin_Tendencia / FE_vec
Demanda_electrico_ruido_2
# Plot the resulting vector
plot(Demanda_electrico_ruido_2, type = "l")
Demanda_electrico_pronostico<-c(Demanda_electrico_ruido, rep(mean(Demanda_electrico_ruido), 12))
plot(Demanda_electrico_pronostico, type="l")
# Devolver estacionalidada
Demanda_electrico_cest<-Demanda_electrico_pronostico*c(FE1_electrico, FE2_electrico,FE3_electrico, FE4_electrico)
Demanda_electrico_cest
LI_demanda_electrico_cest<-LI_demanda_electrico_ajustado*c(FE1_electrico, FE2_electrico,FE3_electrico, FE4_electrico)
LI_demanda_electrico_cest
LS_demanda_electrico_cest<-LS_demanda_electrico_ajustado*c(FE1_electrico, FE2_electrico,FE3_electrico, FE4_electrico)
LS_demanda_electrico_cest
plot(Demanda_electrico_cest, type="l")
lines(LI_demanda_electrico_cest, col="violet")
lines(LS_demanda_electrico_cest, col="violet")
Electrico_Demanded_gas_line_aplicada2 <- predict(Electrico_Demanded_gas_line, newdata = data.frame(Date = extended_demanda_electrico$Date))
Electrico_Demanded_gas_line_aplicada2
Demanda_electrico_pronostico_fin<-Demanda_electrico_cest*Electrico_Demanded_gas_line_aplicada2
LI_demanda_electrico_fin<-LI_demanda_electrico_cest*Electrico_Demanded_gas_line_aplicada2
LS_demanda_electrico_fin<-LS_demanda_electrico_cest*Electrico_Demanded_gas_line_aplicada2
plot(Demanda_electrico_pronostico_fin, type="l", ylim=c(0, max(LS_demanda_electrico_fin, na.rm = TRUE)))
lines(LI_demanda_electrico_fin, col="violet")
lines(LS_demanda_electrico_fin, col="violet")
df_demanda_electrico_pronostico<-data.frame(Demanda_electrico_pronostico_fin, LI_demanda_electrico_fin, LS_demanda_electrico_fin)
View(df_demanda_electrico_pronostico)
knitr::opts_chunk$set(echo = TRUE)
install.packages("readxl")
library("readxl")
nacimientos_mex <-read_excel("Nacimientos_MEX1.xlsx")
install.packages("readxl")
knitr::opts_chunk$set(echo = TRUE)
head(nacimientos_mex)
summary(nacimientos_mex)
typeof(nacimientos_mex)
dim(nacimientos_mex)
plot(nacimientos_mex$Births,type="l")
linea_nacimientos<-lm(Births~Date, data=nacimientos_mex)
linea_nacimientos
linea_nacimientos_aplicada <- predict(linea_nacimientos, newdata = data.frame(Date = nacimientos_mex$Date))
linea_nacimientos_aplicada
plot(nacimientos_mex$Births, type="l")
lines(linea_nacimientos_aplicada, col = "red")
nacimientos_Sin_Tendencia<-nacimientos_mex$Births/linea_nacimientos_aplicad
nacimientos_Sin_Tendencia<-nacimientos_mex$Births/linea_nacimientos_aplicada
plot(nacimientos_Sin_Tendencia, type="l")
knitr::opts_chunk$set(echo = TRUE)
demanda_electrico_filtro_sinTendencia_NiEstacionalidad <-Demanda_electrico_ruido-mean(Demanda_electrico_ruido)
plot(demanda_electrico_filtro_sinTendencia_NiEstacionalidad, type="l")
## Se determina la desviación estandar del error
sd_est_demanda_electrico<-sd(demanda_electrico_filtro_sinTendencia_NiEstacionalidad)
sd_est_demanda_electrico
LI_demanda_electrico<-Demanda_electrico_pronostico[214:225]-2*sd_est_demanda_electrico*c(1:12)^.5
LS_demanda_electrico<-Demanda_electrico_pronostico[214:225]+2*sd_est_demanda_electrico*c(1:12)^.5
## Tambien se debe "crear la linea para nuestros limites" teniendo NA en los valores de datos historicos, así como los 12 valores de limites previamente calculados
LI_demanda_electrico_ajustado<-c(rep(NA, times=213), LI_demanda_electrico)
LI_demanda_electrico_ajustado
LS_demanda_electrico_ajustado<-c(rep(NA, times=213), LS_demanda_electrico)
LS_demanda_electrico_ajustado
# Devolver estacionalidada
Demanda_electrico_cest<-Demanda_electrico_pronostico*c(FE1_electrico, FE2_electrico,FE3_electrico, FE4_electrico)
Demanda_electrico_cest
LI_demanda_electrico_cest<-LI_demanda_electrico_ajustado*c(FE1_electrico, FE2_electrico,FE3_electrico, FE4_electrico)
LI_demanda_electrico_cest
LS_demanda_electrico_cest<-LS_demanda_electrico_ajustado*c(FE1_electrico, FE2_electrico,FE3_electrico, FE4_electrico)
LS_demanda_electrico_cest
plot(Demanda_electrico_cest, type="l")
lines(LI_demanda_electrico_cest, col="violet")
lines(LS_demanda_electrico_cest, col="violet")
knitr::opts_chunk$set(echo = TRUE)
install.packages("readxl")
library("readxl")
Demanda_electrico <-read_excel("Demanda_electrico_2022_full1.xlsx")
head(Demanda_electrico)
summary(Demanda_electrico)
typeof(Demanda_electrico)
dim(Demanda_electrico)
plot(Demanda_electrico$Demanded_Gas, type = "l")
Electrico_Demanded_gas_line<-lm(Demanded_Gas~Date, data=Demanda_electrico)
Electrico_Demanded_gas_line
Electrico_Demanded_gas_line_aplicada <- predict(Electrico_Demanded_gas_line, newdata = data.frame(Date = Demanda_electrico$Date))
Electrico_Demanded_gas_line_aplicada
plot(Demanda_electrico$Demanded_Gas, type="l")
lines(Electrico_Demanded_gas_line_aplicada, col = "red")
Demanda_electrico_Sin_Tendencia<-Demanda_electrico$Demanded_Gas/Electrico_Demanded_gas_line_aplicada
plot(Demanda_electrico_Sin_Tendencia, type="l")
Demanda_electrico_Sin_Tendencia
dim(Demanda_electrico_Sin_Tendencia)
# Generate indices for T1, T2, T3, and T4
# Define the indices for each subset
T1_indices <- c(seq(1, 3), seq(13, 15), seq(25, 27), seq(37, 39), seq(49, 51), seq(61, 63), seq(73, 75), seq(85, 87), seq(97, 99), seq(109, 111), seq(121, 123), seq(133, 135), seq(145, 147), seq(157, 159), seq(169, 171), seq(181, 183), seq(193, 195), seq(205, 207))
T2_indices <- c(seq(4, 6), seq(16, 18), seq(28, 30), seq(40, 42), seq(52, 54), seq(64, 66), seq(76, 78), seq(88, 90), seq(100, 102), seq(112, 114), seq(124, 126), seq(136, 138), seq(148, 150), seq(160, 162), seq(172, 174), seq(184, 186), seq(196, 198), seq(208, 210))
T3_indices <- c(seq(7, 9), seq(19, 21), seq(31, 33), seq(43, 45), seq(55, 57), seq(67, 69), seq(79, 81), seq(91, 93), seq(103, 105), seq(115, 117), seq(127, 129), seq(139, 141), seq(151, 153), seq(163, 165), seq(175, 177), seq(187, 189), seq(199, 201), seq(211, 213))
T4_indices <- c(seq(10, 12), seq(22, 24), seq(34, 36), seq(46, 48), seq(58, 60), seq(70, 72), seq(82, 84), seq(94, 96), seq(106, 108), seq(118, 120), seq(130, 132), seq(142, 144), seq(154, 156), seq(166, 168), seq(178, 180), seq(190, 192), seq(202, 204), seq(214, 216))
# Create the subsets
T1 <- Demanda_electrico_Sin_Tendencia[T1_indices]
T1
T2 <- Demanda_electrico_Sin_Tendencia[T2_indices]
T2
T3 <- Demanda_electrico_Sin_Tendencia[T3_indices]
T3
T4 <- Demanda_electrico_Sin_Tendencia[T4_indices]
T4
FE1_electrico<-mean(T1)/mean(Demanda_electrico_Sin_Tendencia)
FE1_electrico
FE2_electrico<-mean(T2)/mean(Demanda_electrico_Sin_Tendencia)
FE2_electrico
FE3_electrico<-mean(T3)/mean(Demanda_electrico_Sin_Tendencia)
FE3_electrico
FE4_electrico<-mean(T4, na.rm = TRUE)/mean(Demanda_electrico_Sin_Tendencia)
FE4_electrico
Demanda_electrico_ruido<-Demanda_electrico_Sin_Tendencia/c(FE1_electrico, FE2_electrico, FE3_electrico, FE4_electrico)
Demanda_electrico_ruido
plot(Demanda_electrico_ruido, type="l")
demanda_electrico_filtro_sinTendencia_NiEstacionalidad <-Demanda_electrico_ruido-mean(Demanda_electrico_ruido)
plot(demanda_electrico_filtro_sinTendencia_NiEstacionalidad, type="l")
## Se determina la desviación estandar del error
sd_est_demanda_electrico<-sd(demanda_electrico_filtro_sinTendencia_NiEstacionalidad)
sd_est_demanda_electrico
Demanda_electrico_pronostico<-c(Demanda_electrico_ruido, rep(mean(Demanda_electrico_ruido), 12))
plot(Demanda_electrico_pronostico, type="l")
LI_demanda_electrico<-Demanda_electrico_pronostico[214:225]-2*sd_est_demanda_electrico*c(1:12)^.5
LS_demanda_electrico<-Demanda_electrico_pronostico[214:225]+2*sd_est_demanda_electrico*c(1:12)^.5
## Tambien se debe "crear la linea para nuestros limites" teniendo NA en los valores de datos historicos, así como los 12 valores de limites previamente calculados
LI_demanda_electrico_ajustado<-c(rep(NA, times=213), LI_demanda_electrico)
LI_demanda_electrico_ajustado
LS_demanda_electrico_ajustado<-c(rep(NA, times=213), LS_demanda_electrico)
LS_demanda_electrico_ajustado
# Devolver estacionalidada
Demanda_electrico_cest<-Demanda_electrico_pronostico*c(FE1_electrico, FE2_electrico,FE3_electrico, FE4_electrico)
Demanda_electrico_cest
LI_demanda_electrico_cest<-LI_demanda_electrico_ajustado*c(FE1_electrico, FE2_electrico,FE3_electrico, FE4_electrico)
LI_demanda_electrico_cest
LS_demanda_electrico_cest<-LS_demanda_electrico_ajustado*c(FE1_electrico, FE2_electrico,FE3_electrico, FE4_electrico)
LS_demanda_electrico_cest
plot(Demanda_electrico_cest, type="l")
lines(LI_demanda_electrico_cest, col="violet")
lines(LS_demanda_electrico_cest, col="violet")
# create a new data set with 12 additional months
extended_dates_electrico <- seq(as.Date("2005-01-01"), as.Date("2023-09-01"), by = "month")
# create a data frame with 225 rows
extended_demanda_electrico <- data.frame(Date = extended_dates_electrico,
Demanded_Gas = rep(NA, length(extended_dates_electrico)))
# assign values to a subset of Demanded_Gas that corresponds to the length of Demanda_electrico$Demanded_Gas
extended_demanda_electrico$Demanded_Gas[1:length(Demanda_electrico$Demanded_Gas)] <- Demanda_electrico$Demanded_Gas
# print the resulting data frame
extended_demanda_electrico
extended_demanda_electrico$Date <- as.POSIXct(as.character(extended_demanda_electrico$Date), format = "%Y-%m-%d")
extended_demanda_electrico
Electrico_Demanded_gas_line_aplicada2 <- predict(Electrico_Demanded_gas_line, newdata = data.frame(Date = extended_demanda_electrico$Date))
Electrico_Demanded_gas_line_aplicada2
Demanda_electrico_pronostico_fin<-Demanda_electrico_cest*Electrico_Demanded_gas_line_aplicada2
LI_demanda_electrico_fin<-LI_demanda_electrico_cest*Electrico_Demanded_gas_line_aplicada2
LS_demanda_electrico_fin<-LS_demanda_electrico_cest*Electrico_Demanded_gas_line_aplicada2
plot(Demanda_electrico_pronostico_fin, type="l", ylim=c(0, max(LS_demanda_electrico_fin, na.rm = TRUE)))
lines(LI_demanda_electrico_fin, col="violet")
lines(LS_demanda_electrico_fin, col="violet")
df_demanda_electrico_pronostico<-data.frame(Demanda_electrico_pronostico_fin, LI_demanda_electrico_fin, LS_demanda_electrico_fin)
View(df_demanda_electrico_pronostico)
# copy the original data to the new data set
extended_nacimientos_mex$Births[1:length(nacimientos_mex$Births)] <- nacimientos_mex$Births
extended_nacimientos_mex
# fit the model with the extended data set
linea_nacimientos_extended <- lm(Births ~ Date, data = extended_nacimientos_mex)
linea_nacimientos_extended
# predict values for the extended date range
linea_nacimientos_extended_aplicada <- predict(linea_nacimientos_extended,
newdata = data.frame(Date = extended_dates))
linea_nacimientos_extended_aplicada
# plot the predicted values
plot(extended_dates, linea_nacimientos_extended_aplicada, type = "l")
##Creando el vector original + los valores a predecir como NAs
nacimientos_original_para_pron<-c(nacimientos_mex$Births, rep(NA, times=6))
nacimientos_original_para_pron
dim(nacimientos_original_para_pron)
Est_punt_nacimientos<-c(rep(NA, times=27), media_nacimientos_ST*linea_nacimientos_extended_aplicada[28:33])
Est_punt_nacimientos
# plot the original data and the predicted values together
plot(extended_dates, nacimientos_original_para_pron, type="l", xlab="Year", ylab="Births")
lines(extended_dates, Est_punt_nacimientos, col="blue")
LI_naci_ajustado<-c(rep(NA, times=27), LI_naci[28:33]*linea_nacimientos_extended_aplicada[28:33])
LI_naci_ajustado
LS_naci_ajustado<-c(rep(NA, times=27), LS_naci[28:33]*linea_nacimientos_extended_aplicada[28:33])
LS_naci_ajustado
# plot the original data and the predicted values together
plot(extended_dates, nacimientos_original_para_pron, type="l", xlab="Year", ylab="Births")
lines(extended_dates, Est_punt_nacimientos, col="blue")
lines(LI_naci_ajustado, col="purple")
lines(LS_naci_ajustado, col="purple")
LI_naci<-c(rep(NA, times=27), media_nacimientos_ST-Lim_nacimientos)
LI_naci
LS_naci<-c(rep(NA, times=27), media_nacimientos_ST+Lim_nacimientos)
LS_naci
plot(Date_nacimientos2, nacimientos_Sin_Tendencia_para_pron, type="l", ylim = c(0.7,1.3) ,col="Blue")
lines(estimacion_nacimientos, col="Red")
lines(LI_naci, col="Purple")
lines(LS_naci, col="Purple")
# copy the original data to the new data set
extended_nacimientos_mex$Births[1:length(nacimientos_mex$Births)] <- nacimientos_mex$Births
extended_nacimientos_mex
# fit the model with the extended data set
linea_nacimientos_extended <- lm(Births ~ Date, data = extended_nacimientos_mex)
linea_nacimientos_extended
# predict values for the extended date range
linea_nacimientos_extended_aplicada <- predict(linea_nacimientos_extended,
newdata = data.frame(Date = extended_dates))
linea_nacimientos_extended_aplicada
# plot the predicted values
plot(extended_dates, linea_nacimientos_extended_aplicada, type = "l")
##Creando el vector original + los valores a predecir como NAs
nacimientos_original_para_pron<-c(nacimientos_mex$Births, rep(NA, times=6))
nacimientos_original_para_pron
dim(nacimientos_original_para_pron)
Est_punt_nacimientos<-c(rep(NA, times=27), media_nacimientos_ST*linea_nacimientos_extended_aplicada[28:33])
Est_punt_nacimientos
# plot the original data and the predicted values together
plot(extended_dates, nacimientos_original_para_pron, type="l", xlab="Year", ylab="Births")
lines(extended_dates, Est_punt_nacimientos, col="blue")
LI_naci_ajustado<-c(rep(NA, times=27), LI_naci[28:33]*linea_nacimientos_extended_aplicada[28:33])
LI_naci_ajustado
LS_naci_ajustado<-c(rep(NA, times=27), LS_naci[28:33]*linea_nacimientos_extended_aplicada[28:33])
LS_naci_ajustado
# plot the original data and the predicted values together
plot(extended_dates, nacimientos_original_para_pron, type="l", xlab="Year", ylab="Births")
lines(extended_dates, Est_punt_nacimientos, col="blue")
x_vals <- c(rep(NA, times = 27), extended_dates[28:33])
lines(x_vals, LI_naci_ajustado, col = "purple")
lines(x_vals, LS_naci_ajustado, col = "purple")
df_demanda_nacimientoMex_pronostico<-data.frame(nacimientos_original_para_pron,
Est_punt_nacimientos, LI_naci_ajustado, LS_naci_ajustado)
View(df_demanda_nacimientoMex_pronostico)
df_demanda_electrico_pronostico<-data.frame(Demanda_electrico$Demanded_Gas, Demanda_electrico_pronostico_fin, LI_demanda_electrico_fin, LS_demanda_electrico_fin)
df_demanda_electrico_pronostico<-data.frame(Demanda_electrico_cest, Demanda_electrico_pronostico_fin, LI_demanda_electrico_fin, LS_demanda_electrico_fin)
View(df_demanda_electrico_pronostico)
df_demanda_electrico_pronostico<-data.frame(Demanda_electrico$Demanded_Gas, Demanda_electrico_pronostico_fin, LI_demanda_electrico_fin, LS_demanda_electrico_fin)
# Create a data frame with Demanded_Gas
df_demanda_electrico_pronostico <- data.frame(Demanded_Gas = Demanda_electrico$Demanded_Gas)
# Add the other columns using cbind(), which will recycle shorter columns and fill in with NA
df_demanda_electrico_pronostico <- cbind(df_demanda_electrico_pronostico,
Demanda_electrico_pronostico_fin,
LI_demanda_electrico_fin,
LS_demanda_electrico_fin)
# Create a data frame with the predicted values and intervals
df_demanda_electrico_pronostico <- data.frame(Demanded_Gas = c(Demanda_electrico$Demanded_Gas[1:213], rep(NA, 12)),
Demanda_electrico_pronostico_fin = Demanda_electrico_pronostico_fin,
LI_demanda_electrico_fin = LI_demanda_electrico_fin,
LS_demanda_electrico_fin = LS_demanda_electrico_fin)
# View the resulting data frame
View(df_demanda_electrico_pronostico)
Demanda_electrico <-read_excel("Demanda_electrico_2022_full1_pp.xlsx")
head(Demanda_electrico)
summary(Demanda_electrico)
typeof(Demanda_electrico)
dim(Demanda_electrico)
plot(Demanda_electrico$Demanded_Gas, type = "l")
Electrico_Demanded_gas_line<-lm(Demanded_Gas~Date, data=Demanda_electrico)
Electrico_Demanded_gas_line
Electrico_Demanded_gas_line_aplicada <- predict(Electrico_Demanded_gas_line, newdata = data.frame(Date = Demanda_electrico$Date))
Electrico_Demanded_gas_line_aplicada
plot(Demanda_electrico$Demanded_Gas, type="l")
lines(Electrico_Demanded_gas_line_aplicada, col = "red")
Demanda_electrico_Sin_Tendencia<-Demanda_electrico$Demanded_Gas/Electrico_Demanded_gas_line_aplicada
plot(Demanda_electrico_Sin_Tendencia, type="l")
Demanda_electrico_Sin_Tendencia
dim(Demanda_electrico_Sin_Tendencia)
# Generate indices for T1, T2, T3, and T4
# Define the indices for each subset
T1_indices <- c(seq(1, 3), seq(13, 15), seq(25, 27), seq(37, 39), seq(49, 51), seq(61, 63), seq(73, 75), seq(85, 87), seq(97, 99), seq(109, 111), seq(121, 123), seq(133, 135), seq(145, 147), seq(157, 159), seq(169, 171), seq(181, 183), seq(193, 195))
T2_indices <- c(seq(4, 6), seq(16, 18), seq(28, 30), seq(40, 42), seq(52, 54), seq(64, 66), seq(76, 78), seq(88, 90), seq(100, 102), seq(112, 114), seq(124, 126), seq(136, 138), seq(148, 150), seq(160, 162), seq(172, 174), seq(184, 186), seq(196, 198))
T3_indices <- c(seq(7, 9), seq(19, 21), seq(31, 33), seq(43, 45), seq(55, 57), seq(67, 69), seq(79, 81), seq(91, 93), seq(103, 105), seq(115, 117), seq(127, 129), seq(139, 141), seq(151, 153), seq(163, 165), seq(175, 177), seq(187, 189), seq(199, 201))
T4_indices <- c(seq(10, 12), seq(22, 24), seq(34, 36), seq(46, 48), seq(58, 60), seq(70, 72), seq(82, 84), seq(94, 96), seq(106, 108), seq(118, 120), seq(130, 132), seq(142, 144), seq(154, 156), seq(166, 168), seq(178, 180), seq(190, 192), seq(202, 204))
# Create the subsets
T1 <- Demanda_electrico_Sin_Tendencia[T1_indices]
T1
T2 <- Demanda_electrico_Sin_Tendencia[T2_indices]
T2
T3 <- Demanda_electrico_Sin_Tendencia[T3_indices]
T3
T4 <- Demanda_electrico_Sin_Tendencia[T4_indices]
T4
FE1_electrico<-mean(T1)/mean(Demanda_electrico_Sin_Tendencia)
FE1_electrico
FE2_electrico<-mean(T2)/mean(Demanda_electrico_Sin_Tendencia)
FE2_electrico
FE3_electrico<-mean(T3)/mean(Demanda_electrico_Sin_Tendencia)
FE3_electrico
FE4_electrico<-mean(T4, na.rm = TRUE)/mean(Demanda_electrico_Sin_Tendencia)
FE4_electrico
Demanda_electrico_ruido<-Demanda_electrico_Sin_Tendencia/c(FE1_electrico, FE2_electrico, FE3_electrico, FE4_electrico)
Demanda_electrico_ruido
plot(Demanda_electrico_ruido, type="l")
demanda_electrico_filtro_sinTendencia_NiEstacionalidad <-Demanda_electrico_ruido-mean(Demanda_electrico_ruido)
plot(demanda_electrico_filtro_sinTendencia_NiEstacionalidad, type="l")
## Se determina la desviación estandar del error
sd_est_demanda_electrico<-sd(demanda_electrico_filtro_sinTendencia_NiEstacionalidad)
sd_est_demanda_electrico
Demanda_electrico_pronostico<-c(Demanda_electrico_ruido, rep(mean(Demanda_electrico_ruido), 12))
plot(Demanda_electrico_pronostico, type="l")
LI_demanda_electrico<-Demanda_electrico_pronostico[202:213]-2*sd_est_demanda_electrico*c(1:12)^.5
LS_demanda_electrico<-Demanda_electrico_pronostico[202:213]+2*sd_est_demanda_electrico*c(1:12)^.5
## Tambien se debe "crear la linea para nuestros limites" teniendo NA en los valores de datos historicos, así como los 12 valores de limites previamente calculados
LI_demanda_electrico_ajustado<-c(rep(NA, times=201), LI_demanda_electrico)
LI_demanda_electrico_ajustado
LS_demanda_electrico_ajustado<-c(rep(NA, times=201), LS_demanda_electrico)
LS_demanda_electrico_ajustado
# Devolver estacionalidada
Demanda_electrico_cest<-Demanda_electrico_pronostico*c(FE1_electrico, FE2_electrico,FE3_electrico, FE4_electrico)
Demanda_electrico_cest
LI_demanda_electrico_cest<-LI_demanda_electrico_ajustado*c(FE1_electrico, FE2_electrico,FE3_electrico, FE4_electrico)
LI_demanda_electrico_cest
LS_demanda_electrico_cest<-LS_demanda_electrico_ajustado*c(FE1_electrico, FE2_electrico,FE3_electrico, FE4_electrico)
LS_demanda_electrico_cest
plot(Demanda_electrico_cest, type="l")
lines(LI_demanda_electrico_cest, col="violet")
lines(LS_demanda_electrico_cest, col="violet")
# create a new data set with 12 additional months
extended_dates_electrico <- seq(as.Date("2005-01-01"), as.Date("2022-09-01"), by = "month")
# create a data frame with 225 rows
extended_demanda_electrico <- data.frame(Date = extended_dates_electrico,
Demanded_Gas = rep(NA, length(extended_dates_electrico)))
# assign values to a subset of Demanded_Gas that corresponds to the length of Demanda_electrico$Demanded_Gas
extended_demanda_electrico$Demanded_Gas[1:length(Demanda_electrico$Demanded_Gas)] <- Demanda_electrico$Demanded_Gas
# print the resulting data frame
extended_demanda_electrico
extended_demanda_electrico$Date <- as.POSIXct(as.character(extended_demanda_electrico$Date), format = "%Y-%m-%d")
extended_demanda_electrico
Electrico_Demanded_gas_line_aplicada2 <- predict(Electrico_Demanded_gas_line, newdata = data.frame(Date = extended_demanda_electrico$Date))
Electrico_Demanded_gas_line_aplicada2
Demanda_electrico_pronostico_fin<-Demanda_electrico_cest*Electrico_Demanded_gas_line_aplicada2
LI_demanda_electrico_fin<-LI_demanda_electrico_cest*Electrico_Demanded_gas_line_aplicada2
LS_demanda_electrico_fin<-LS_demanda_electrico_cest*Electrico_Demanded_gas_line_aplicada2
plot(Demanda_electrico_pronostico_fin, type="l", ylim=c(0, max(LS_demanda_electrico_fin, na.rm = TRUE)))
lines(LI_demanda_electrico_fin, col="violet")
lines(LS_demanda_electrico_fin, col="violet")
# Create a data frame with the predicted values and intervals
df_demanda_electrico_pronostico <- data.frame(Demanded_Gas = c(Demanda_electrico$Demanded_Gas[1:213], rep(NA, 12)),
Demanda_electrico_pronostico_fin = Demanda_electrico_pronostico_fin,
LI_demanda_electrico_fin = LI_demanda_electrico_fin,
LS_demanda_electrico_fin = LS_demanda_electrico_fin)
# Create a data frame with the predicted values and intervals
df_demanda_electrico_pronostico <- data.frame(Demanded_Gas = c(Demanda_electrico$Demanded_Gas[1:201], rep(NA, 12)),
Demanda_electrico_pronostico_fin = Demanda_electrico_pronostico_fin,
LI_demanda_electrico_fin = LI_demanda_electrico_fin,
LS_demanda_electrico_fin = LS_demanda_electrico_fin)
# View the resulting data frame
View(df_demanda_electrico_pronostico)
Demanda_electrico_completa <-read_excel("Demanda_electrico_2022_full1.xlsx")
Demanda_electrico_completa
# Create a data frame with the predicted values and intervals
df_demanda_electrico_pronostico_completo <- data.frame(Demanded_Gas = Demanda_electrico_completa$Demanded_Gas,
Demanda_electrico_pronostico_fin = Demanda_electrico_pronostico_fin,
LI_demanda_electrico_fin = LI_demanda_electrico_fin,
LS_demanda_electrico_fin = LS_demanda_electrico_fin)
# View the resulting data frame
View(df_demanda_electrico_pronostico_completo)
Demanda_electrico_ts <-ts(Demanda_electrico$Demanded_Gas, frequency =4, start =c(2015,1))
Demanda_electrico_ts
Demanda_electrico_ts <-ts(Demanda_electrico$Demanded_Gas, frequency =4, start =c(2005,1))
Demanda_electrico_ts
Demanda_electrico_ts <-ts(Demanda_electrico$Demanded_Gas, frequency =12, start =c(2005,1))
Demanda_electrico_ts
plot(Demanda_electrico_ts)
plot(Demanda_electrico_ts, head="A")
plot(Demanda_electrico_ts, header="A")
plot(Demanda_electrico_ts, main="Demanda electrico train data in time series data type")
Demanda_electrico_ts_hw1 <-HoltWinters(Demanda_electrico_ts, seasonal = 'multiplicative')
Demanda_electrico_ts_hw1
pllot(Demanda_electrico_ts_hw1, main="Aplicaicón del método de Holt Winters a Demanda electrico train data")
plot(Demanda_electrico_ts_hw1, main="Aplicaicón del método de Holt Winters a Demanda electrico train data")
Demanda_electrico_ts_hw1_fc <- forecast(Demanda_electrico_ts_hw1, h=12, level=0.95)
# Install the forecast package
install.packages("forecast")
# Load the forecast package
library(forecast)
Demanda_electrico_ts_hw1_fc <- forecast(Demanda_electrico_ts_hw1, h=12, level=0.95)
Demanda_electrico_ts_hw1_fc
plot(Demanda_electrico_ts_hw1_fc)
nacimientos_mex
summary(nacimientos_mex)
typeof(nacimientos_mex)
dim(nacimientos_mex)
knitr::opts_chunk$set(echo = TRUE)
install.packages("readxl")
library("readxl")
PAE_mex <-read_excel("PAE_MEX_pp.xlsx")
